FROM ubuntu:18.04

ENV PYTHONPATH="$PYTHONPATH:/workspace"

RUN apt-get update && \
    apt-get -y install git && \
    apt-get -y install python3-pip && \
    apt-get -y install libmysqlclient-dev

COPY ./app /workspace/app
COPY ./.env /workspace/.env     
COPY ./requirments/requirments-web.txt /workspace/requirments-web.txt

RUN pip3 install --upgrade pip && \
    pip3 install -r /workspace/requirments-web.txt

WORKDIR /workspace
RUN git clone https://github.com/Nuitka/Nuitka.git && \
    cd Nuitka && \
    python3 setup.py install

RUN mv app/main.py ./main.py && \
    python3 -m nuitka --module app --include-package=app && \
    python3 -m nuitka main.py

RUN rm -r app Nuitka main.py
